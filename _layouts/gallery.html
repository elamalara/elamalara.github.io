<!DOCTYPE html>
<html>

  {% include head.html %}

  <body class="galleryPage">

      <section style="background-image: url({{ "/images/peacock.jpg" | prepend: site.baseurl }});"> <span>Picture of a peacock</span></section>
      <section style="background-image: url({{ "/images/ela.jpg" | prepend: site.baseurl }});">     <span>Ela</span> </section>
      <section style="background-image: url({{ "/images/kayak.jpg" | prepend: site.baseurl }});">   <span>Kayaking in Ontario</span> </section>
      <section style="background-image: url({{ "/images/chicago.jpg" | prepend: site.baseurl }});"> <span>A trip to Chicago</span> </section>
      <section> <img src="{{ "/images/peacock.jpg" | prepend: site.baseurl }}"/> <span>Picture of a peacock</span></section>
      <section> <img src="{{ "/images/ela.jpg" | prepend: site.baseurl }}"/>     <span>Ela</span> </section>
      <section> <img src="{{ "/images/kayak.jpg" | prepend: site.baseurl }}"/>   <span>Kayaking in Ontario</span> </section>
      <section> <img src="{{ "/images/chicago.jpg" | prepend: site.baseurl }}"/> <span>A trip to Chicago</span> </section>
        {{ content }}

      <article id="description">
        <p id="titleParagraph">This will contain description of the image you see above it. This text won't move.</p>
        <p id="descriptionParagraph">New paragraphs will fade in as old paragraphs fade out.</p>
      </article>

      <a class="navigation previous" href="#">&lt;</a>
      <a class="navigation next" href="#">&gt;</a>
  </body>

  <script>
  $(function() {

    $('html, body').mousewheel(function(e, delta) {
      if( Math.abs(e.deltaX) ) {
        return
      } else {
        this.scrollLeft -= (e.deltaY * 150);
      }
      e.preventDefault();
    });

    var currentElement = -1;

    function getCurrentElement() {
      var currentPosition = $('html').scrollLeft();
      var elementWidth = $('html').width() * 0.9;
      console.log(currentPosition + ", " + elementWidth + ", " + elementWidth * 2);
      return Math.floor((currentPosition + elementWidth * 0.5) / elementWidth);
    }

    function getElementX(index) {
      var elementWidth = $('html').width() * 0.9;
      return index * elementWidth;
    }

    $(window).scroll(function(e) {
      var newElement = getCurrentElement();
      if (newElement != currentElement)
      {
        currentElement = newElement;
        var elementParent = $( '.galleryPage>section').eq(newElement);
        var elementDescription = elementParent.children('span').html();
        $('#description').stop().fadeOut(300).fadeIn(300);
        setTimeout(function() {
          $('#titleParagraph').html(elementDescription);
        }, 300);
      }
    });

    $('.previous').click(function(e){
      e.preventDefault();
      $('html, body').stop().animate({
          scrollLeft: getElementX(getCurrentElement() - 1)
      }, 600);
    });

    $('.next').click(function(e){
      e.preventDefault();
      $('html, body').stop().animate({
          scrollLeft: getElementX(getCurrentElement() + 1)
      }, 600);
    });

  });
  </script>

</html>
